# plan-review

Claude Codeのプランモードで提示されたプランを、最小単位の決定事項に分解して一つずつ確認するスキル。

## 何ができるか

Claude Codeのプランモードでは、タスクを依頼するとまず実行計画（プラン）が提示されます。このプランには多数の決定事項が含まれており、一括で承認すると意図しない判断まで通してしまうことがあります。

plan-reviewは、プランを「この方針でいいですか？」にy/nで答えられる最小単位に分解し、一件ずつ確認していくスキルです。

**重要: このスキルはプランの確認専用です。実行は行いません。**

## 使い方

### 1. インストール

[koi](https://github.com/inadati/koi)（Claude Codeスキルパッケージマネージャー）を使う場合:

```bash
koi add plan-review -r claude-basic-skills
```

手動でインストールする場合:

```bash
mkdir -p .claude/skills/plan-review
# このリポジトリの SKILL.md を .claude/skills/plan-review/ に配置
```

### 2. 自動起動

plan-reviewはClaude Codeのplanモードでプランを承認した直後に自動起動します。手動で呼び出す必要はありません。

### 3. 確認の流れ

#### まずプランファイルを読み込む

`~/.claude/plans/` 内の最新のプランファイルを自動で特定します。複数ある場合は一覧が表示され、どれを確認するか選べます。

#### 全件一覧が表示される

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
プラン確認: note-post スキル作成（全15件）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  1. スキル名を "note-post" にする
  2. 投稿に BrowserMCP を使用する
  3. 記事生成は Claude が直接行う
  ...
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

#### 一件ずつ確認が始まる

```
確認 3/15

記事生成は Claude 自身が直接行います。
別途 Claude API を呼び出すのではなく、
Claude Code の Claude が直接記事本文を生成します。

理由: セッション内にすでに Claude が存在しているため
外部 API 呼び出しは不要です。

こちらを承認しますか？
```

#### 入力方法

| 入力 | 動作 |
|------|------|
| `y` | 承認 → 次の決定事項へ |
| `n` | 却下 → 変更案を提示 |
| 自由記述 | 変更指示として扱う → 変更案を提示 |
| `q` | 確認を中断 → その時点までの結果を表示 |

承認は **y一文字** で次に進めます。変更や議論をしたい場合は自由にテキストを入力できます。音声入力（Aqua Voice等）を使うとタイピングの負担なく対話できます。

#### 全件完了後

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
確認完了: 承認 13件 / 変更 2件 / 却下 0件
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
変更した決定事項:
  #4 ログイン: 手動→半自動化に変更
  #8 設定保存先: CLAUDE.md→別ファイルに分離
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

## なぜプランレビューが必要か

プランモードのプランには、ディレクトリ構成、技術選定、ファイル命名、処理順序など、多数の判断が含まれています。一括承認すると:

- 自分が意識していなかった決定まで通してしまう
- あとから「こうしたかった」と気づいても手戻りが大きい
- プランが長いほど見落としが増える

plan-reviewは、プランの認知負荷を下げるために「分解して一つずつ確認する」アプローチを取ります。

## 技術的な情報

- **使用ツール**: `Read`, `Glob` のみ（読み取り専用）
- **Write / Edit / Bash は使用しない**: 確認専用スキルのため
- **プランファイルの場所**: `~/.claude/plans/`
- **対応環境**: Claude Code

## ライセンス

MIT

## 関連

- [koi](https://github.com/inadati/koi) - Claude Codeスキルパッケージマネージャー
